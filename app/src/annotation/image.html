<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title></title>

    <!-- Style CSS -->
    <link href="./css/style.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- Bootstrap CSS-->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/todc-bootstrap/3.3.7-3.3.13/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-switch/3.3.4/css/bootstrap3/bootstrap-switch.css" rel="stylesheet">

</head>

<!-- no text highlighting -->
<body class="noselect" style="display:none">
<p hidden id="label_type">{{ .Task.ProjectOptions.LabelType }}</p>
<p hidden id="item_type">{{ .Task.ProjectOptions.ItemType }}</p>
<div id="keyboard_usage_window">
    <div class="panel panel-default">
        <div class="panel-heading active">
            Keyboard Usage
        </div>
        <div class="key_usage">
            <div>
                <p><span><kbd>?</kbd></span>
                    <span>Toggle Keyboard Usage display</span></p>
            </div>
            <div>
                <p><span><kbd>Esc</kbd></span> <span>Deselect label</span>
                </p>
            </div>
            <div>
                <p><span><kbd>Backspace</kbd> / <kbd>delete</kbd></span> <span>Delete selected label</span>
                </p>
            </div>
            <div>
                <p><span><kbd>+</kbd></span> <span>Zoom in</span></p>
            </div>
            <div>
                <p><span><kbd>-</kbd></span> <span>Zoom out</span></p>
            </div>
            <div>
                  <p><span><kbd>&larr;</kbd></span> <span>Previous item</span></p>
            </div>
            <div>
                  <p><span><kbd>&rarr;</kbd></span> <span>Next item</span></p>
            </div>
            <template id="seg_usage">
              <div>
                  <p><span><kbd>&uarr;</kbd></span> <span>Bring a selected label forward</span></p>
              </div>
              <div>
                  <p><span><kbd>f</kbd></span> <span>Bring a selected label to front</span></p>
              </div>
              <div>
                  <p><span><kbd>&darr;</kbd></span> <span>Bring a selected label backward</span></p>
              </div>
              <div>
                  <p><span><kbd>b</kbd></span> <span>Bring a selected label to back</span></p>
              </div>
              <div>
                  <p><span><kbd>u</kbd></span> <span>Unlink selected label</span></p>
              </div>
              <div>
                  <p><span><kbd>c</kbd></span> <span>When hovering over midpoint, change the edge to bezier curve</span></p>
              </div>
              <div>
                  <p><span><kbd>s</kbd></span> <span>Toggle on/off quick draw mode</span></p>
              </div>
              <div>
                  <p><span><kbd>Alt</kbd></span> <span>Toggle path options along a polygon during quick draw mode</span></p>
              </div>
            </template>
        </div>

    </div>
</div>

<div class="container_wrapper" id="container_wrapper">
    <div class="container" id="container">

        <!-- Heading -->
        <div id="heading_row" class="row p-0 m-0">
            <div class="col-lg-12">
                <h2 class="page-header"> <span id="page-title"></span>
                    <small>version 0.1.0</small>
                    <a type="button" class="btn btn-info btn-popover" id="instruction_btn"
                       data-toggle="popover" data-placement="right"
                       href="http://data-bdd.berkeley.edu/label/bbox/instruction.html"
                       target="view_window"
                       data-content="Please view instructions and annotate bounding boxes of given categories.">
                        Instruction
                    </a>
                    <div style="float:right;">
                        <small>Labels:</small>
                        <small id="label_count">0</small>
                        <small class="col-lg-offset-0">Lights:</small>
                        <small id="light_count">0</small>
                        <div class="btn-group">
                            <button id="increase_btn" class="btn btn-primary">+</button>
                            <button href="#" id="decrease_btn" class="btn btn-primary">
                                -
                            </button>
                        </div>
                        <div class="btn-group">
                            <button id="prev_btn" class="btn btn-primary">&laquo;</button>
                            <button href="#" id="next_btn" class="btn btn-primary">
                                &raquo;
                            </button>
                        </div>
                        <a href="#" id="save_btn"
                           class="btn btn-primary btn-primary">Save</a>
                    </div>

                </h2>
            </div>
        </div>

        <!-- Toolbox -->
        <div class="row">
            <div class="col-md-2" style="max-width:200px">
                <div id="toolbox" class="panel panel-default">
                    <!-- list of control sections -->
                    <a href="#" class="list-group-item">
                        <div id="custom_categories" class="form-group">
                            <p>Label Category</p>
                        </div>
                        <div id="custom_attributes">
                            {{ range $key, $value := .Task.ProjectOptions.Attributes }}
                            <div class="form-group"
                                 id="custom_attribute_{{ $value.Name }}_div">
                                <input id="custom_attribute_{{ $value.Name }}"
                                       name="custom_attribute_{{ $value.Name }}">
                            </div>
                            {{ end }}
                        </div>
                    </a>
                    <template id="video_btns">
                        <!-- object out of frame button -->
                        <a href="#" id="end_btn" class="btn list-group-item">End
                            Object Track</a>
                    </template>
                    <template id="seg_btns">
                        <a href="#" id="quickdraw_btn" class="btn list-group-item" style="white-space: normal;">
                            <kbd>s</kbd> Quickdraw
                        </a>
                        <a href="#" id="link_btn" class="btn list-group-item">
                            Link
                        </a>
                    </template>
                    <!-- remove button -->
                    <a href="#" id="delete_btn" class="btn list-group-item">Remove</a>
                </div>
            </div>

            <div id="div_main">
                <div id="div_canvas">
                    <canvas id="image_canvas">
                        Unsupported browser!
                    </canvas>
                    <canvas id="hidden_canvas">
                        Unsupported browser!
                    </canvas>
                    <div id="crosshair" style="visibility:none">
                        <div id="crosshair-h" class="hair"></div>
                        <div id="crosshair-v" class="hair"></div>
                    </div>
                </div>
                <div id="player_controls" style="visibility:hidden">
                    <!-- frame counter -->
                    <div id="frame_counter"> 1</div>
                    <!-- play/pause button -->
                    <button id="play_button" type="button">
                        <!-- button initializes paused, so use the play icon -->
                        <i id="play_button_icon" class="fa fa-play"></i>
                    </button>
                    <!-- video progress slider -->
                    <input id="video_slider" class="slider" type="range"
                           min="1"
                           max="{{ .Task.ProjectOptions.VideoMetaData.NumFrames }}"
                           value="1"/>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- TEMPLATE VALUES -->
<i id="frame_rate" class="template-val">{{ .Task.ProjectOptions.VideoMetaData.TBR }}</i>

<!-- JAVASCRIPT -->

<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>

<!-- Bootstrap JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/todc-bootstrap/3.3.7-3.3.13/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-switch/3.3.4/js/bootstrap-switch.js"></script>

<script src="./js/sat.js"></script>

<!-- manages bounding boxes -->
<script src="./js/utils.js"></script>
<script src="./js/video.js"></script>
<script src="./js/image.js"></script>
<script src="./js/shape.js"></script>
<script src="./js/box2d.js"></script>
<script src="./js/seg2d.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/sprintf/1.1.1/sprintf.min.js"></script>

<script type="text/javascript">
  document.getElementById('frame_rate').style.display = "none";
  let showElementById = function(id) {
    let elem = document.getElementById(id);
    elem.style.visibility = 'visible';
  };
  let showTemplateById = function(id) {
    let temp = document.getElementById(id);
    let clone = temp.content.cloneNode(true);
    temp.parentNode.appendChild(clone);
  };

  $(document).ready(function () {
    let labelType = {{ .Task.ProjectOptions.LabelType }};
    let itemType = {{ .Task.ProjectOptions.ItemType }};
    let labelClass;
    if (labelType === 'box2d') {
      showElementById("crosshair");
      labelClass = Box2d;
    } else if (labelType === 'segmentation' || labelType === 'lane') {
      labelClass = Seg2d;
      if (labelType === 'segmentation') {
        showTemplateById("seg_btns");
        showTemplateById("seg_usage");
      }
    }
    if (itemType === 'image') {
      new Sat(SatImage, labelClass);
    }
    if (itemType === 'video') {
      showElementById("player_controls");
      showTemplateById("video_btns");
      new SatVideo(labelClass);
    }
    document.addEventListener("keydown", function (e) {
      let eventObj = window.event ? event : e;
      if (eventObj.keyCode === 191 && eventObj.shiftKey) {
        // if the user pressed '?':
        $("#keyboard_usage_window").toggle();
      }
    });
  });
  $('body').show();
</script>

</body>

</html>
